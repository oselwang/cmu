var container='<div class="col-md-6 col-xs-12" id="penjualan-sp-detail"> <div class="x_panel"> <div class="x_title"> <h2>Penjualan Spare Part<small>Info Detail</small> </h2> <div class="clearfix"></div> </div> <div class="x_content"> <br/> <div class="form-group"> <label class="control-label col-md-3 col-sm-3 col-xs-12" for="">Code Spare Part <span class="required">*</span> </label> <div class="col-md-5 col-sm-5 col-xs-10"> <input type="text" id="" required="required"class="form-control col-md-7 col-xs-12" name="code"> <input type="hidden" name="detail_part_id"> </div> <div class="col-md-1 col-sm-1 col-xs-2"> <button type="button" class="btn btn-primary" id="find-detail-sp">Cari</button> </div> </div> <div class="form-group"> <label class="control-label col-md-3 col-sm-3 col-xs-12" for="qty">Kuantitas Pembelian </label> <div class="col-md-6 col-sm-6 col-xs-12"> <input type="text" id="qty" name="qty" required="required" class="form-control col-md-7 col-xs-12"> </div> </div> <div class="form-group"> <label class="control-label col-md-3 col-sm-3 col-xs-12" for="ref_date">Harga Jual </label> <div class="col-md-5 col-sm-5 col-xs-10"> <input type="text" disabled id="harga_jual" class="form-control col-md-7 col-xs-12"> </div> <div class="col-md-1 col-sm-1 col-xs-2"> <a href="'+defaultUrl+'bengkel/detail-sp" class="btn btn-primary">Ubah</a> </div> </div> <div class="form-group"> <label class="control-label col-md-3 col-sm-3 col-xs-12" for="ref_date">Stock </label> <div class="col-md-6 col-sm-6 col-xs-12"> <input type="text" disabled id="stock" class="form-control col-md-7 col-xs-12"> </div> </div> <div class="form-group"> <label class="control-label col-md-3 col-sm-3 col-xs-12" for="ref_date">Status </label> <div class="col-md-6 col-sm-6 col-xs-12"> <input type="text" disabled id="status" class="form-control col-md-7 col-xs-12"> </div> </div> <div class="form-group"> <div class="col-md-offset-3 col-sm-offset-3 col-md-9 col-sm-9" id="add-remove-button-container"> <button type="button" class="btn btn-default btn-sm" id="add-spare-part">Tambah Spare Part </button> <button type="button" class="btn btn-default btn-sm" id="remove-spare-part">Hapus Spare Part </button> </div> </div> <div class="ln_solid"></div> </div> </div> </div>';$(document).ready(function(){$("#datatable").DataTable({}),$("#create-penjualan-sp-form").submit(function(a){a.preventDefault();var t=$(this),e=t.serializeArray();$.ajax({type:"post",data:e,url:defaultUrl+"bengkel/penjualan-sp/create",success:function(a){location.reload()},error:function(a){var t=$.parseJSON(a.responseText);$("#error-create-penjualan-sp").empty(),$.each(t,function(a,t){$("#error-create-penjualan-sp").removeClass("hidden").append("<li>"+t+"</li>")}),$("html,body").animate({scrollTop:0},"slow")}})}).on("click","#penjualan-sp-detail #add-spare-part",function(a){a.preventDefault();var t=$(this),e=t.parent().parent().parent().parent().parent();e.clone().appendTo("#penjualan-sp-detail-container").find('input[type="text"]').val(""),t.remove()}).on("click","#penjualan-sp-detail #remove-spare-part",function(a){a.preventDefault();var t=$(this),e=t.parent().parent().parent().parent().parent();e.remove(),0==$("#add-spare-part").length&&(0==$("#penjualan-sp-detail").length?$("#create-customer-button-container").append('<button class="btn btn-default btn-sm" type="button" id="add-spare-part">Tambah Spare Part</button>'):$("#penjualan-sp-detail:last").find("#add-remove-button-container").prepend('<button class="btn btn-default btn-sm" type="button" id="add-spare-part">Tambah Spare Part</button>'))}).on("click","#create-customer-button-container #add-spare-part",function(a){a.preventDefault(),$("#penjualan-sp-detail-container").append(container),$(this).remove()}).on("click","#find-customer-bengkel",function(a){a.preventDefault();var t=$('input[name="phone"]').val();$.ajax({type:"get",url:defaultUrl+"bengkel/customer-bengkel/phone/"+t,success:function(a){jQuery.isEmptyObject(a)?($("#nama").val("Data tidak ditemukan"),$("#alamat").val("Data tidak ditemukan"),$("#kota").val("Data tidak ditemukan")):($('input[name="customer_bengkel_id"]').val(a.id),$("#nama").val(a.nama),$("#alamat").val(a.alamat),$("#kota").val(a.kota.nama))}})}).on("click","#penjualan-sp-detail #find-detail-sp",function(a){a.preventDefault();var t=$(this).parent().parent().parent(),e=t.find('input[name="code"]').val();$.ajax({type:"get",url:defaultUrl+"bengkel/detail-sp/code/"+e,success:function(a){jQuery.isEmptyObject(a)?(t.find("#harga_jual").val("Data tidak ditemukan"),t.find("#stock").val("Data tidak ditemukan"),t.find("#status").val("Data tidak ditemukan")):(0==a.stock?($("html,body").animate({scrollTop:0},"slow"),$("#error-create-penjualan-sp").removeClass("hidden").append("<li>Tidak bisa input jika stock 0</li>"),$("#submit-button").prop("disabled",!0)):($("#error-create-penjualan-sp").addClass("hidden"),$("#submit-button").prop("disabled",!1)),t.find('input[name="detail_sp_id[]"]').val(a.id),t.find("#harga_jual").val(a.harga_jual),t.find("#stock").val(a.stock),t.find("#status").val(a.status))}})}),$("#delete-button").on("click",function(a){a.preventDefault(),swal({title:"Apakah kamu yakin?",type:"warning",showCancelButton:!0,confirmButtonColor:"#e63d53",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(function(a){a.value&&$.ajax({type:"post",url:defaultUrl+"bengkel/penjualan-sp/delete",data:{penjualan_sp_id:$('input[name="penjualan_sp_id"]').val(),_token:$('input[name="_token"]').val()},success:function(a){window.location.href=defaultUrl+"bengkel/penjualan-sp"}})})})});